<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Animated Weather Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            transition: background 1s ease-in-out;
            background-color: #1e293b;
            color: #e2e8f0;
        }
        .glass-card {
            background: rgba(30, 41, 59, 0.7);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border-radius: 1.25rem;
            border: 1px solid rgba(255, 255, 255, 0.15);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.25);
            transition: transform 0.3s ease, opacity 0.5s ease;
        }
        .glass-card:hover {
            transform: translateY(-6px);
        }
        .weather-theme {
            transition: background 1s ease;
        }
        .weather-icon {
            width: 140px;
            height: 140px;
            margin: 0 auto;
            animation: fadeIn 1s ease-in-out;
        }
        @keyframes fadeIn {
            0% { opacity: 0; transform: scale(0.8); }
            100% { opacity: 1; transform: scale(1); }
        }
        .loading-spinner {
            border: 4px solid rgba(255, 255, 255, 0.2);
            border-top: 4px solid #4f46e5;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .hourly-icon {
            width: 40px;
            height: 40px;
            margin: 4px 0;
        }
    </style>
</head>
<body class="flex items-center justify-center min-h-screen p-4 weather-theme">
    <div class="glass-card p-8 w-full max-w-3xl">
        <h1 class="text-4xl font-extrabold text-center mb-8">Animated Weather Dashboard</h1>

        <div class="flex flex-col md:flex-row gap-4 mb-8">
            <input type="text" id="location-input" class="flex-grow p-4 rounded-xl bg-gray-700 text-white border border-gray-600 focus:outline-none focus:ring-2 focus:ring-indigo-500" placeholder="Enter city name (e.g., London, Tokyo)">
            <button id="search-button" class="bg-indigo-600 text-white p-4 rounded-xl font-semibold hover:bg-indigo-500 transition-colors">Get Weather</button>
        </div>

        <div id="loading" class="hidden"><div class="loading-spinner"></div></div>

        <div id="weather-card" class="hidden glass-card p-8 opacity-0 transition-opacity duration-700">
            <div id="weather-icon-container" class="mb-6 text-center"></div>
            <h2 id="city-name" class="text-4xl font-bold text-center mb-6"></h2>

            <div class="flex flex-col md:flex-row justify-between items-center text-center md:text-left mb-8">
                <div>
                    <p id="temperature" class="text-6xl font-extrabold mb-2"></p>
                    <p id="description" class="text-2xl capitalize text-gray-300 mb-2"></p>
                    <p id="feels-like" class="text-lg text-gray-400"></p>
                </div>
                <div class="flex gap-6 text-lg mt-6 md:mt-0" id="current-stats"></div>
            </div>

            <div class="flex justify-around items-center text-center p-4 glass-card mb-8 rounded-xl">
                <div class="text-xl">
                    <p class="text-indigo-400">High</p>
                    <p id="temp-high" class="font-bold text-white"></p>
                </div>
                <div class="text-xl">
                    <p class="text-indigo-400">Low</p>
                    <p id="temp-low" class="font-bold text-white"></p>
                </div>
            </div>

            <div class="mb-8">
                <h3 class="text-2xl font-semibold mb-4 text-white">Hourly Forecast</h3>
                <div id="hourly-forecast-container" class="flex overflow-x-auto gap-4 py-4 scrollbar-thin scrollbar-thumb-gray-600 scrollbar-track-gray-800"></div>
            </div>

            <div>
                <h3 class="text-2xl font-semibold mb-4 text-white">7-Day Forecast</h3>
                <div id="daily-forecast-container" class="space-y-4"></div>
            </div>
        </div>

        <div id="message-box" class="text-center mt-6 text-sm text-red-400"></div>
    </div>

    <script>
        const locationInput = document.getElementById('location-input');
        const searchButton = document.getElementById('search-button');
        const weatherCard = document.getElementById('weather-card');
        const loading = document.getElementById('loading');
        const cityNameEl = document.getElementById('city-name');
        const temperatureEl = document.getElementById('temperature');
        const descriptionEl = document.getElementById('description');
        const feelsLikeEl = document.getElementById('feels-like');
        const tempHighEl = document.getElementById('temp-high');
        const tempLowEl = document.getElementById('temp-low');
        const hourlyForecastContainer = document.getElementById('hourly-forecast-container');
        const dailyForecastContainer = document.getElementById('daily-forecast-container');
        const weatherIconContainer = document.getElementById('weather-icon-container');
        const messageBox = document.getElementById('message-box');
        const body = document.body;

        const weatherCodeMap = { /* ... same as before ... */ };
        const weatherIcons = { /* ... same as before ... */ };

        function showMessage(text, isError = true) {
            messageBox.textContent = text;
            messageBox.style.color = isError ? '#f87171' : '#a7f3d0';
        }

        function applyWeatherTheme(weatherCode) { /* same logic */ }
        function displayWeatherIcon(weatherCode) { /* same logic */ }

        async function fetchWeather(location) {
            if (!location) { showMessage("Please enter a location."); return; }
            showMessage("Fetching weather data...", false);
            weatherCard.classList.add('hidden');
            weatherCard.style.opacity = 0;
            loading.classList.remove('hidden');

            try {
                const geocodeData = await (await fetch(`https://geocoding-api.open-meteo.com/v1/search?name=${location}&count=1&language=en&format=json`)).json();
                if (!geocodeData.results?.length) { showMessage(`Location not found: ${location}`); loading.classList.add('hidden'); return; }

                const { latitude: lat, longitude: lon, name, country } = geocodeData.results[0];
                const fullLocation = name + (country ? `, ${country}` : '');

                const weatherData = await (await fetch(`https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&current_weather=true&temperature_unit=fahrenheit&windspeed_unit=mph&hourly=apparent_temperature,weathercode,temperature_2m&daily=temperature_2m_max,temperature_2m_min,uv_index_max,weathercode&forecast_days=7&timezone=auto`)).json();
                const airData = await (await fetch(`https://air-quality-api.open-meteo.com/v1/air-quality?latitude=${lat}&longitude=${lon}&hourly=us_aqi&timezone=auto`)).json();

                const current = weatherData.current_weather;
                const hourly = weatherData.hourly;
                const daily = weatherData.daily;

                cityNameEl.textContent = fullLocation;
                temperatureEl.textContent = `${Math.round(current.temperature)}°F`;
                descriptionEl.textContent = weatherCodeMap[current.weathercode];
                const currentHour = new Date(current.time).getHours();
                feelsLikeEl.textContent = `Feels like: ${Math.round(hourly.apparent_temperature[currentHour])}°F`;
                tempHighEl.textContent = `${Math.round(daily.temperature_2m_max[0])}°F`;
                tempLowEl.textContent = `${Math.round(daily.temperature_2m_min[0])}°F`;

                weatherCard.classList.remove('hidden');
                setTimeout(() => weatherCard.style.opacity = 1, 50);
                loading.classList.add('hidden');

                applyWeatherTheme(current.weathercode);
                displayWeatherIcon(current.weathercode);

                // Populate hourly forecast with icons
                hourlyForecastContainer.innerHTML = '';
                for (let i = currentHour; i < currentHour + 24; i++) {
                    if (i >= hourly.time.length) break;
                    const hour = new Date(hourly.time[i]).getHours();
                    const temp = Math.round(hourly.temperature_2m[i]);
                    const code = hourly.weathercode[i];
                    const div = document.createElement('div');
                    div.className = 'flex flex-col items-center p-3 rounded-lg bg-gray-700 w-24 flex-shrink-0 text-center transition-transform transform hover:scale-105';
                    let iconSvg = code <= 3 ? weatherIcons.sunny : code <= 48 ? weatherIcons.cloudy : code <= 67 ? weatherIcons.rainy : code <= 77 ? weatherIcons.snowy : weatherIcons.stormy;
                    div.innerHTML = `<p class="font-semibold">${hour}:00</p>${iconSvg}<p class="text-sm capitalize mt-1">${weatherCodeMap[code]}</p><p class="text-xl mt-1">${temp}°F</p>`;
                    hourlyForecastContainer.appendChild(div);
                }

                // Populate daily forecast same as before

            } catch (err) {
                showMessage("Failed to fetch weather data.");
                loading.classList.add('hidden');
                console.error(err);
            }
        }

        searchButton.addEventListener('click', () => fetchWeather(locationInput.value.trim()));
        locationInput.addEventListener('keypress', e => { if (e.key === 'Enter') searchButton.click(); });
    </script>
</body>
</html>
